#!/usr/bin/env bash
#
# Test script to demonstrate enhanced package installation visibility
# This simulates what users will see during KyOS installation
#

echo "ğŸ‰ KyOS Installation Progress Demo"
echo "=================================="
echo ""

# Simulate base system installation
echo "ğŸ‰ ================================"
echo "ğŸ“¦ INSTALLING BASE SYSTEM PACKAGES"
echo "ğŸ‰ ================================"
echo "You will see real-time progress below with visual indicators:"
echo "  ğŸ“¦ = Package operations"
echo "  ğŸ” = Checking/verification"
echo "  ğŸ“¥ = Downloading"
echo "  ğŸ§© = Dependency resolution"
echo ""

echo "ğŸš€ Installing 12 base system packages..."
echo "ğŸ“‹ Packages: base base-devel linux linux-firmware grub efibootmgr dosfstools os-prober mtools networkmanager dhcpcd git sudo"
echo ""

# Simulate package installation output
packages=(
    "base"
    "base-devel" 
    "linux"
    "linux-firmware"
    "grub"
    "efibootmgr"
    "dosfstools"
    "os-prober"
    "mtools"
    "networkmanager"
    "dhcpcd"
    "git"
    "sudo"
)

for i in "${!packages[@]}"; do
    pkg="${packages[$i]}"
    current=$((i + 1))
    total=${#packages[@]}
    
    echo "ğŸ“¦ ($current/$total) Installing $pkg..."
    sleep 0.5
    echo "ğŸ” checking dependencies..."
    sleep 0.3
    echo "ğŸ§© resolving dependencies..."
    sleep 0.3
    echo "ğŸ“¥ downloading $pkg..."
    sleep 0.4
    echo "âœ… $pkg installed successfully"
    echo ""
done

echo ""
echo "âœ… Base system installation completed successfully!"
echo "ğŸ“Š Installed 12 packages successfully"
echo ""

# Simulate desktop package installation
echo "ğŸ‰ ================================="
echo "ğŸ–¥ï¸  INSTALLING DESKTOP PACKAGES"
echo "ğŸ‰ ================================="
echo ""

desktop_packages=("qtile" "firefox" "alacritty" "thunar" "neofetch")

for i in "${!desktop_packages[@]}"; do
    pkg="${desktop_packages[$i]}"
    current=$((i + 1))
    total=${#desktop_packages[@]}
    
    echo ""
    echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
    echo "â”‚ [$current/$total] Installing: $pkg"
    echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
    echo ""
    
    sleep 0.3
    echo "  ğŸ“¦ Installing $pkg..."
    sleep 0.4
    echo "  ğŸ” Checking package integrity..."
    sleep 0.3
    echo "  ğŸ“¥ Downloading package files..."
    sleep 0.5
    echo "  ğŸ§© Resolving dependencies..."
    sleep 0.3
    echo ""
    echo "  âœ… Successfully installed: $pkg"
    echo ""
    
    percentage=$((current * 100 / total))
    echo "ğŸš€ Progress: $percentage% ($current/$total packages completed)"
    echo ""
done

echo ""
echo "ğŸ‰ Installation Complete!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… All packages installed successfully"
echo "ğŸ‰ Welcome to KyOS - Dragon Arch!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
